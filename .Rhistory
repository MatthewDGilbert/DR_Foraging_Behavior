"p < 0.05" = "#5DADE2",
"p < 0.01" = "royalblue3",
"p < 0.001" = "darkblue"),
name = "Significance") +
theme_classic() +
theme(
#plot.title = element_text(size = 18, color = "black"),                       # Larger title
axis.title.x = element_text(size = 18, color = "black"),                      # Larger x-axis title
axis.title.y = element_text(size = 18, color = "black"),                      # Larger y-axis title
legend.title = element_text(size = 20, color = "black"),                      # Larger legend title
legend.text = element_text(size = 15, color = "black"))+                      # Larger legend text
labs(
#title = "Adjusted Pairwise Fisher's Test for Foraging Technique",
x = "\nSpecies",
y = "Species\n")+
geom_text(data = data.frame(x = species,
y = rep(-0.5, length(species)),
Significance = "Not Significant"),
aes(x = x, y = y, label = x),
fontface = ifelse(species %in% bold_species, "bold", "plain"),
angle = 30, hjust = 1, size = 16) +
# Add y-axis labels
geom_text(data = data.frame(x = rep(-0.5, length(species)),
y = species,
Significance = "Not Significant"),
aes(x = x, y = y, label = y),
fontface = ifelse(species %in% bold_species, "bold", "plain"),
hjust = 1, size = 16)
figure2B
# Reorder species to place BBTO and BWVI first
species_order <- c("BBTO", "BWVI", setdiff(unique(adjusted_pval_table$Species1), c("BBTO", "BWVI")))
adjusted_pval_table$Species1 <- factor(adjusted_pval_table$Species1, levels = species_order)
adjusted_pval_table$Species2 <- factor(adjusted_pval_table$Species2, levels = species_order)
# Add a significance level category
adjusted_pval_table$Significance <- cut(
adjusted_pval_table$Adjusted_P,
breaks = c(-Inf, 0.001, 0.01, 0.05, Inf),
labels = c("p < 0.001", "p < 0.01", "p < 0.05", "Not Significant"))
# Add a significance level category
adjusted_pval_table
figure2B <- ggplot(adjusted_pval_table, aes(Species1, Species2, fill = Significance)) +
geom_tile(color = "white") +
scale_fill_manual(
values = c(
"Not Significant" = "gray80",
"p < 0.05" = "#5DADE2",
"p < 0.01" = "royalblue3",
"p < 0.001" = "darkblue"),
name = "Significance") +
theme_classic() +
theme(
axis.text.x = element_text(angle = 30, hjust = 1, size = 16, color = "black", face = ifelse(levels(adjusted_pval_table$Species1) %in% c("BBTO", "BWVI"), "bold", "plain")),  # Larger x-axis labels
axis.text.y = element_text(size = 16, color = "black", face = ifelse(levels(adjusted_pval_table$Species1) %in% c("BBTO", "BWVI"), "bold", "plain")),                        # Larger y-axis labels
#plot.title = element_text(size = 18, color = "black"),          # Larger title
axis.title.x = element_text(size = 18, color = "black"),                      # Larger x-axis title
axis.title.y = element_text(size = 18, color = "black"),                      # Larger y-axis title
legend.title = element_text(size = 20, color = "black"),                       # Larger legend title
legend.text = element_text(size = 15, color = "black"))+                        # Larger legend text
labs(
#title = "Adjusted Pairwise Fisher's Test for Foraging Technique",
x = "\nSpecies",
y = "Species\n")
figure2B <- ggdraw(figure2B) + draw_plot_label(label = "B", x = 0.005, y = 0.98, size = 22, fontface = "bold")  # adjust x, y as needed
ggsave(filename = "Figure2B.png", plot = figure2B, width = 10, height = 6, dpi = 1000, units = "in")
# Filter out BBTO and BWVI species and remove missing data
filtered_data <- Combined_Location %>%
filter(!V1 %in% c("BBTO", "BWVI")) %>%
drop_na(V1, V2, V3)  # Ensure no missing values in Species (V1), Foraging_Type (V2), or Count (V3)
# Get unique species names
species <- unique(filtered_data$V1)
# Create an empty matrix to store raw p-values
pairwise_pvals <- matrix(NA, nrow = length(species), ncol = length(species),
dimnames = list(species, species))
# Perform pairwise Fisher's Exact Tests with simulated p-values
for (i in 1:(length(species) - 1)) {
for (j in (i + 1):length(species)) {
# Subset data for the two species being compared
subset_data <- filtered_data %>%
filter(V1 %in% c(species[i], species[j])) %>%
select(V1, V2, V3)
# Create a contingency table
contingency_table <- xtabs(V3 ~ V2 + V1, data = subset_data)
# Perform Fisher's Exact Test with simulated p-values
if (nrow(contingency_table) > 1 && ncol(contingency_table) > 1) {
test_result <- fisher.test(contingency_table, simulate.p.value = TRUE, B = 10000)
# Store the p-value in the matrix
pairwise_pvals[species[i], species[j]] <- test_result$p.value
pairwise_pvals[species[j], species[i]] <- test_result$p.value # Mirror the result
}
}
}
pairwise_df <- melt(pairwise_pvals, varnames = c("Species1", "Species2"), value.name = "P_Value")
pairwise_df <- pairwise_df[!is.na(pairwise_df$P_Value), ]
# Adjust p-values using Bonferroni correction (multiply by number of comparisons)
n_comparisons <- nrow(pairwise_df)
pairwise_df$Adjusted_P <- pairwise_df$P_Value * n_comparisons
# Add a significance level category
pairwise_df$Significance <- cut(
pairwise_df$Adjusted_P,
breaks = c(-Inf, 0.001, 0.01, 0.05, Inf),
labels = c("P < 0.001", "P < 0.01", "P < 0.05", "Not Significant"))
# Add a significance level category
pairwise_df$Significance <- cut(
pairwise_df$Adjusted_P,
breaks = c(-Inf, 0.001, 0.01, 0.05, Inf),
labels = c("p < 0.001", "p < 0.01", "p < 0.05", "Not Significant"))
# Plot the heatmap of adjusted p-values
figure3B <- ggplot(pairwise_df, aes(Species1, Species2, fill = Significance)) +
geom_tile(color = "white") +
scale_fill_manual(
values = c(
"Not Significant" = "gray80",
"p < 0.05" = "#5DADE2",
"p < 0.01" = "royalblue3",
"p < 0.001" = "darkblue"
),
name = "Significance"
) +
theme_minimal() +
theme(
axis.text.x = element_text(angle = 30, hjust = 1, size = 16, color = "black"),
axis.text.y = element_text(size = 16, color = "black"),                        # Larger y-axis labels
#plot.title = element_text(size = 18, color = "black"),          # Larger title
axis.title.x = element_text(size = 18, color = "black"),                      # Larger x-axis title
axis.title.y = element_text(size = 18, color = "black"),                      # Larger y-axis title
legend.title = element_text(size = 20, color = "black"),                       # Larger legend title
legend.text = element_text(size = 15, color = "black"))+                        # Larger legend text
labs(
#title = "Adjusted Pairwise Fisher's Test for Foraging Technique",
x = "\nSpecies",
y = "Species\n")
figure3B <- ggdraw(figure3B) + draw_plot_label(label = "B", x = 0.005, y = 0.98, size = 22, fontface = "bold")  # adjust x, y as needed
ggsave(filename = "Figure3B.png", plot = figure3B, width = 10, height = 5.3, dpi = 1000, units = "in")
ggsave(filename = "Figure3B.jpeg", plot = figure3B, width = 10, height = 5.3, dpi = 1000, units = "in")
ggsave(filename = "Figure2B.jpeg", plot = figure2B, width = 10, height = 6, dpi = 1000, units = "in")
# load libraries
library(dplyr)
library(ggpattern)
library(ggtext)
library(ggplot2)
library(tidyr)
library(ggrepel)
# Load data frame from folder
Stacked = read.csv("Sorted_Foraging_Technique.csv", header=F)
# Load data frame from folder
Stacked = read.csv("data/Sorted_Foraging_Technique.csv", header=F)
Combined_Location = read.csv("data/Sorted_Foraging_Substrate.csv", header=F)
unsorted_data = read.csv("data/Unsorted_Reduced_Dataset.csv", header=T)
# Step 1: create the dataframe---
Species <- c(rep("AMRE" , 8) , rep("BAWW" , 8) , rep("BBTO" , 8) , rep("BWVI" , 8) , rep("CMWA" , 8) , rep("NOPA" , 8) , rep("OVEN" , 8) , rep("PAWA" , 8) , rep("PRAW" , 8) , rep("YRWA" , 8) )
Behavior <- rep(c("Consuming Plant" , "Drinking Nectar" , "Flycatching", "Gleaning", "Hover-Gleaning", "Poking Ground", "Pounching", "Snatching") , 10)
Proportion <- abs(Stacked$V3)
data <- data.frame(Species,Behavior,Proportion)
# sort data for standardized
sorted_data <- data
# Restructure the species order: BBTO and BWVI first, followed by the others
sorted_data$Species <- factor(sorted_data$Species,
c("BBTO", "BWVI", "OVEN", "PAWA", "YRWA", "AMRE", "PRAW", "BAWW", "NOPA", "CMWA"))
behavior_patterns <- c(
"Consuming Plant" = "stripe",
"Drinking Nectar" = "crosshatch",
"Flycatching" = "circle",
"Gleaning" = "none",
"Hover-Gleaning" = "stripe",
"Poking Ground" = "crosshatch",
"Pounching" = "circle",
"Snatching" = "none")
behavior_colors <- c(
"Consuming Plant" = "#D55E00",
"Drinking Nectar" = "gold",
"Flycatching" = "#0072B2",
"Gleaning" = "#009E73",
"Hover-Gleaning" = "#56B4E9",
"Poking Ground" = "#C47F17",
"Pounching" = "#CC79A7",
"Snatching" = "#999999")
# Step 3: Plot ----
figure2A <- ggplot(sorted_data, aes(x = Species, y = Proportion, fill = Behavior, pattern = Behavior)) +
geom_bar_pattern(stat = "identity", position = "fill", pattern_density = 0.15, pattern_fill = "black", pattern_spacing = 0.02, pattern_key_scale_factor = 0.6) +
scale_fill_manual(values = behavior_colors) +
scale_pattern_manual(values = behavior_patterns) +
labs(fill = "Foraging Behavior", pattern = "Foraging Behavior", x = "Species", y = "Proportion\n") +
theme_minimal() +
theme(
text = element_text(size = 20, color = "black"),
axis.text.y = element_text(size = 16, color = "black"),
axis.title.x = element_blank(),
axis.title.y = element_text(size = 18, color = "black"),
legend.title = element_text(size = 20, color = "black"),
legend.text = element_text(size = 15, color = "black"),
axis.text.x = element_text(angle = 30, hjust = 1, size = 16, color = "black",
face = ifelse(levels(sorted_data$Species) %in% c("BBTO", "BWVI"), "bold", "plain")))
figure2A <- ggdraw(figure2A) + draw_plot_label(label = "A", x = 0.005, y = 0.98, size = 22, fontface = "bold")  # adjust x, y as needed
ggsave(filename = "Figure2A.jpeg", plot = figure2A, width = 10, height = 6, dpi = 1000, units = "in")
# Step 3: Plot ----
figure2A <- ggplot(sorted_data, aes(x = Species, y = Proportion, fill = Behavior, pattern = Behavior)) +
geom_bar_pattern(stat = "identity", position = "fill", pattern_density = 0.15, pattern_fill = "black", pattern_spacing = 0.02, pattern_key_scale_factor = 0.6) +
scale_fill_manual(values = behavior_colors) +
scale_pattern_manual(values = behavior_patterns) +
labs(fill = "Foraging Behavior", pattern = "Foraging Technique", x = "Species", y = "Proportion\n") +
theme_minimal() +
theme(
text = element_text(size = 20, color = "black"),
axis.text.y = element_text(size = 16, color = "black"),
axis.title.x = element_blank(),
axis.title.y = element_text(size = 18, color = "black"),
legend.title = element_text(size = 20, color = "black"),
legend.text = element_text(size = 15, color = "black"),
axis.text.x = element_text(angle = 30, hjust = 1, size = 16, color = "black",
face = ifelse(levels(sorted_data$Species) %in% c("BBTO", "BWVI"), "bold", "plain")))
figure2A <- ggdraw(figure2A) + draw_plot_label(label = "A", x = 0.005, y = 0.98, size = 22, fontface = "bold")  # adjust x, y as needed
ggsave(filename = "Figure2A.jpeg", plot = figure2A, width = 10, height = 6, dpi = 1000, units = "in")
# Step 3: Plot ----
figure2A <- ggplot(sorted_data, aes(x = Species, y = Proportion, fill = Behavior, pattern = Behavior)) +
geom_bar_pattern(stat = "identity", position = "fill", pattern_density = 0.15, pattern_fill = "black", pattern_spacing = 0.02, pattern_key_scale_factor = 0.6) +
scale_fill_manual(values = behavior_colors) +
scale_pattern_manual(values = behavior_patterns) +
labs(fill = "Foraging Behavior", pattern = "Foraging Technique", x = "Species", y = "Proportion\n") +
theme_minimal() +
theme(
text = element_text(size = 20, color = "black"),
axis.text.y = element_text(size = 16, color = "black"),
axis.title.x = element_blank(),
axis.title.y = element_text(size = 18, color = "black"),
legend.title = element_text(size = 20, color = "black"),
legend.text = element_text(size = 15, color = "black"),
axis.text.x = element_text(angle = 30, hjust = 1, size = 16, color = "black",
face = ifelse(levels(sorted_data$Species) %in% c("BBTO", "BWVI"), "bold", "plain")))
figure2A <- ggdraw(figure2A) + draw_plot_label(label = "A", x = 0.005, y = 0.98, size = 22, fontface = "bold")  # adjust x, y as needed
ggsave(filename = "Figure2A.jpeg", plot = figure2A, width = 10, height = 6, dpi = 1000, units = "in")
sorted_data
# Step 1: create the dataframe ---
Species <- c(rep("AMRE" , 8) , rep("BAWW" , 8) , rep("BBTO" , 8) , rep("BWVI" , 8) , rep("CMWA" , 8) , rep("NOPA" , 8) , rep("OVEN" , 8) , rep("PAWA" , 8) , rep("PRAW" , 8) , rep("YRWA" , 8) )
Technique <- rep(c("Consuming Plant" , "Drinking Nectar" , "Flycatching", "Gleaning", "Hover-Gleaning", "Poking Ground", "Pounching", "Snatching") , 10)
Proportion <- abs(Stacked$V3)
data <- data.frame(Species,Technique,Proportion)
# Step 2: Assign order, colors and patterns ----
sorted_data <- data
# Restructure the species order: BBTO and BWVI first, followed by the others
sorted_data$Species <- factor(sorted_data$Species,
c("BBTO", "BWVI", "OVEN", "PAWA", "YRWA", "AMRE", "PRAW", "BAWW", "NOPA", "CMWA"))
Technique_patterns <- c(
"Consuming Plant" = "stripe",
"Drinking Nectar" = "crosshatch",
"Flycatching" = "circle",
"Gleaning" = "none",
"Hover-Gleaning" = "stripe",
"Poking Ground" = "crosshatch",
"Pounching" = "circle",
"Snatching" = "none")
Technique_colors <- c(
"Consuming Plant" = "#D55E00",
"Drinking Nectar" = "gold",
"Flycatching" = "#0072B2",
"Gleaning" = "#009E73",
"Hover-Gleaning" = "#56B4E9",
"Poking Ground" = "#C47F17",
"Pounching" = "#CC79A7",
"Snatching" = "#999999")
# Step 3: Plot ----
figure2A <- ggplot(sorted_data, aes(x = Species, y = Proportion, fill = Technique, pattern = Technique)) +
geom_bar_pattern(stat = "identity", position = "fill", pattern_density = 0.15, pattern_fill = "black", pattern_spacing = 0.02, pattern_key_scale_factor = 0.6) +
scale_fill_manual(values = Technique_colors) +
scale_pattern_manual(values = Technique_patterns) +
labs(fill = "Foraging Technique", pattern = "Foraging Technique", x = "Species", y = "Proportion\n") +
theme_minimal() +
theme(
text = element_text(size = 20, color = "black"),
axis.text.y = element_text(size = 16, color = "black"),
axis.title.x = element_blank(),
axis.title.y = element_text(size = 18, color = "black"),
legend.title = element_text(size = 20, color = "black"),
legend.text = element_text(size = 15, color = "black"),
axis.text.x = element_text(angle = 30, hjust = 1, size = 16, color = "black",
face = ifelse(levels(sorted_data$Species) %in% c("BBTO", "BWVI"), "bold", "plain")))
figure2A <- ggdraw(figure2A) + draw_plot_label(label = "A", x = 0.005, y = 0.98, size = 22, fontface = "bold")  # adjust x, y as needed
ggsave(filename = "Figure2A.jpeg", plot = figure2A, width = 10, height = 6, dpi = 1000, units = "in")
# Step 1: Define substrate mapping and desired factor levels. ----
substrate_map <- c(
"G" = "Ground", "D" = "Dead Material", "T" = "Trunk",
"S" = "Branch", "B" = "Branch",
"F" = "Twig", "OF" = "Twig", "UF" = "Twig",
"L" = "Leaf", "OL" = "Leaf", "UL" = "Leaf",
"Y" = "Flower/Berry", "W" = "Flower/Berry",
"SW" = "Other")
species_order <- c("BBTO", "BWVI", "OVEN", "PAWA", "YRWA",
"AMRE", "PRAW", "BAWW", "NOPA", "CMWA")
location_order <- c("Ground", "Dead Material", "Trunk",
"Branch", "Twig", "Leaf",
"Flower/Berry", "Other")
# Step 2: Aggregate and align data ----
sorted_data <- Combined_Location %>%
rename(Species = V1, Code = V2, Value = V3) %>%
mutate(Category = substrate_map[Code]) %>%
group_by(Species, Category) %>%
summarise(Proportion = sum(Value), .groups = "drop") %>%
complete(Species = species_order, Category = location_order, fill = list(Proportion = 0)) %>%
mutate(
Species = factor(Species, levels = species_order),
Foraging_Location = factor(Category, levels = location_order)
) %>%
select(Species, Foraging_Location, Proportion)
sorted_data
# Define color and pattern mappings
foraging_colors <- c(
"Ground" = "#8B4513",
"Dead Material" = "#D55E00",
"Trunk" = "royalblue",
"Branch" = "#56B4E9",
"Twig" = "#9FD3E9",
"Leaf" = "#009E73",
"Flower/Berry" = "#CC79A7",
"Other" = "#999999"
)
substrate_patterns <- c(
"Ground" = "stripe",
"Dead Material" = "crosshatch",
"Trunk" = "circle",
"Branch" = "none",
"Twig" = "stripe",
"Leaf" = "crosshatch",
"Flower/Berry" = "circle",
"Other" = "none")
substrate_patterns <- c(
"Ground" = "none",
"Dead Material" = "crosshatch",
"Trunk" = "circle",
"Branch" = "stripe",
"Twig" = "circle",
"Leaf" = "none",
"Flower/Berry" = "stripe",
"Other" = "crosshatch")
# Create the plot
figure3A <- ggplot(sorted_data,aes(fill = Foraging_Location,y = Proportion,x = Species,pattern = Foraging_Location)) +
geom_bar_pattern(stat = "identity",position = "fill",pattern_density = 0.15,pattern_fill = "black",pattern_spacing = 0.02,pattern_key_scale_factor = 0.6) +
scale_fill_manual(values = foraging_colors) +
scale_pattern_manual(values = substrate_patterns) +
theme_minimal() +
labs(fill = "Foraging Substrate",pattern = "Foraging Substrate",x = "Species",y = "Proportion\n") +
theme(
text = element_text(size = 20, color = "black"),
axis.text.y = element_text(size = 16, color = "black"),
axis.title.x = element_blank(),
axis.title.y = element_text(size = 18, color = "black"),
legend.title = element_text(size = 20, color = "black"),
legend.text = element_text(size = 15, color = "black"),
axis.text.x = element_text(angle = 30, hjust = 1, size = 16, color = "black",
face = ifelse(levels(sorted_data$Species) %in% c("BBTO", "BWVI"), "bold", "plain")))
figure3A <- ggdraw(figure3A) + draw_plot_label(label = "A", x = 0.005, y = 0.98, size = 22, fontface = "bold")  # adjust x, y as needed
ggsave(filename = "Figure3A.png", plot = figure3A, width = 10, height = 6, dpi = 1000, units = "in")
ggsave(filename = "Figure3A.jpeg", plot = figure3A, width = 10, height = 6, dpi = 1000, units = "in")
data_filtered <- unsorted_data
# Step 1: select data
data_filtered <- unsorted_data
data_filtered <- data_filtered %>%
mutate(Species = factor(Species, levels = c("BBTO", "BWVI", setdiff(unique(Species), c("BBTO", "BWVI")))))
# Step2: Compute means and confidence intervals for each species ----
species_summary <- data_filtered %>%
group_by(Species) %>%
summarize(
mean_x = mean(Canopy.height),
mean_y = mean(Height.in.Canopy),
se_x = sd(Canopy.height) / sqrt(n()),
se_y = sd(Height.in.Canopy) / sqrt(n()),
lower_x = mean_x - qt(0.975, df = n() - 1) * se_x,
upper_x = mean_x + qt(0.975, df = n() - 1) * se_x,
lower_y = mean_y - qt(0.975, df = n() - 1) * se_y,
upper_y = mean_y + qt(0.975, df = n() - 1) * se_y)
shape_values <- c(
"BBTO" = 21, "BWVI" = 21, "PAWA" = 21, "OVEN" = 21, "YRWA" = 21,
"AMRE" = 21, "PRAW" = 21, "BAWW" = 21, "NOPA" = 21, "CMWA" = 21)
species_summary$label_dx <- c(0.35, 0.35, 0.35, 0.35, 0.35, 0.35, 0.35, -0.35, 0.35, 0.35)  # example: n = 10
species_summary$label_dy <- c(-0.03, 0.03, 0.03, 0.03, 0.03, 0.03, 0.03, -0.03, 0.03, 0.03)
figure1 <- ggplot(species_summary, aes(x = mean_x, y = mean_y, color = Species, shape = Species, fill = Species)) +
geom_errorbar(aes(ymin = lower_y, ymax = upper_y), width = 0.1, size = 1.2) +
geom_errorbarh(aes(xmin = lower_x, xmax = upper_x), height = 0.01, size = 1.2) +
geom_point(size = 4, stroke = 1) +
geom_text(
aes(x = mean_x + label_dx, y = mean_y + label_dy, label = Species),
size = 5.5,
show.legend = FALSE) +
labs(x = "\n Canopy Height (m)", y = "Proportional Height within Canopy \n") +
theme_minimal() +
scale_shape_manual(values = shape_values) +
theme(
legend.position = "none",
axis.title = element_text(size = 18),
axis.text = element_text(size = 16))
ggsave(filename = "Figure1.png", plot = figure1, width = 8, height = 6, dpi = 1000, units = "in")
ggsave(filename = "Figure1.jpeg", plot = figure1, width = 8, height = 6, dpi = 1000, units = "in")
# Step 1: sort it by mean height
unsorted_data <- unsorted_data %>%
mutate(Species = reorder(Species, Height.in.Canopy, FUN = mean))
figure_box <- ggplot(unsorted_data, aes(x = Species, y = Height.in.Canopy, fill = Species)) +
geom_boxplot(alpha = 0.65, outlier.shape = NA) +
geom_jitter(width = 0.15, height = 0.02, size = 2, alpha = 0.5) +  # Adjust jitter width here
labs(x = "Species", y = "Foraging Height in Canopy (Proportion)") +
theme_minimal() +
ylim(0, 1) +
theme(
text = element_text(size = 18, color = "black"),
axis.text.x = element_text(size = 14, color = "black"),
axis.text.y = element_text(size = 14, color = "black"),
legend.position = "none")
# Save the plot
ggsave(filename = "FigureS2.png", plot = figure_box,
width = 8, height = 6, dpi = 1000, units = "in")
# Save the plot
ggsave(filename = "FigureS2.jpeg", plot = figure_box,
width = 8, height = 6, dpi = 1000, units = "in")
library(sf)
library(ggplot2)
library(rnaturalearth)
library(rnaturalearthhires)
# Set up file path for the KML file
kml_file <- "Figures/FPC.kml"
# Step 1: Set up file path for the KML file
kml_file <- "Figures/FPC.kml"
# Load the KML shapefile
fpc_shape <- st_read(kml_file)
setwd("~/github_files/DR_Forbehav")
# Install required packages if not already installed
library(sf)
library(ggplot2)
library(rnaturalearth)
library(rnaturalearthhires)
install.packages("rnaturalearthhires")
library(rnaturalearthhires)
# Step 1: Set up file path for the KML file
kml_file <- "Figures/FPC.kml"
# Load the KML shapefile
fpc_shape <- st_read(kml_file)
# Step 1: Set up file path for the KML file
kml_file <- "Figures/FPC.kml"
# Step 1: Set up file path for the KML file
kml_file <- file.path("Figures/FPC.kml")
# Load the KML shapefile
fpc_shape <- st_read(kml_file)
# Download high-resolution basemap for the Dominican Republic with administrative divisions
dom_rep_states <- ne_states(country = "Dominican Republic", returnclass = "sf")
# Download high-resolution basemap for the Dominican Republic with administrative divisions
dom_rep_states <- ne_states(country = "Dominican Republic", returnclass = "sf")
# Highlight La Altagracia province
la_altagracia <- dom_rep_states[dom_rep_states$name == "La Altagracia", ]
# Coordinates for Labels and Points
annotations <- data.frame(
label = c("La Altagracia \nProvince", "Study Area"),
x = c(-68.5, -68.15),
y = c(19, 18.3)
)
# Coordinates for Punta Cana (point and label)
punta_cana <- data.frame(
label = "Punta Cana",
x = -68.35,
y = 18.6
)
# Step 1: Set up file path for the KML file
kml_file <- file.path("Figures/FPC.kml")
# Load the KML shapefile
fpc_shape <- st_read(kml_file)
# Download high-resolution basemap for the Dominican Republic with administrative divisions
dom_rep_states <- ne_states(country = "Dominican Republic", returnclass = "sf")
# Highlight La Altagracia province
la_altagracia <- dom_rep_states[dom_rep_states$name == "La Altagracia", ]
# Coordinates for Labels and Points
annotations <- data.frame(
label = c("La Altagracia \nProvince", "Study Area"),
x = c(-68.5, -68.15),
y = c(19, 18.3)
)
# Coordinates for Punta Cana (point and label)
punta_cana <- data.frame(
label = "Punta Cana",
x = -68.35,
y = 18.6
)
santo_domingo <- data.frame(
label = "Santo\nDomingo",
x = -69.93,
y = 18.47
)
# Create the map
map <- ggplot() +
# Plot all provinces in the Dominican Republic
geom_sf(data = dom_rep_states, fill = "gray95", color = "black", size = 0.5) +
# Highlight La Altagracia province
geom_sf(data = la_altagracia, fill = "gray85", color = "black", size = 0.7) +
# Overlay the KML shapefile
geom_sf(data = fpc_shape, fill = "gray45", color = "black", alpha = 0.8) +
# Add a filled circle for Punta Cana
geom_point(data = punta_cana, aes(x = x, y = y), color = "black", size = 3, shape = 21, fill = "black") +
geom_point(data = santo_domingo, aes(x = x, y = y), color = "black", size = 3, shape = 21, fill = "black") +
# Add label for Punta Cana
geom_text(data = punta_cana, aes(x = x, y = y, label = label), nudge_y = 0.1, size = 4, fontface = "bold") +
geom_text(data = santo_domingo, aes(x = -69.86, y = 18.25, label = label), nudge_y = 0.1, size = 4, fontface = "bold") +
# Add line pointing to the Study Area
geom_segment(aes(x = -68.15, y = 18.35, xend = -68.35, yend = 18.515), color = "black", size = 1) +
# Add labels for La Altagracia and Study Area
geom_text(data = annotations, aes(x = x, y = y, label = label), size = 4, fontface = "bold") +
# Adjust limits to focus on La Altagracia
coord_sf(xlim = c(-70.8, -68), ylim = c(18.0, 19.8)) +
# Theme adjustments for black-and-white styling
#theme_void() +
theme(
panel.grid.major = element_line(color = "gray80", size = 0.2), # Black major grid lines
panel.grid.minor = element_line(color = "gray80", size = 0.1), # Black minor grid lines
panel.background = element_rect(fill = "white"), # White background
#axis.text = element_blank(), # Remove axis text
#axis.ticks = element_blank(), # Remove axis ticks
axis.title = element_blank()) # Remove axis titles
ggsave(filename = "FigureS1.png", plot = map, width = 7, height = 5, dpi = 1000, units = "in")
ggsave(filename = "FigureS1.jpeg", plot = map, width = 7, height = 5, dpi = 1000, units = "in")
